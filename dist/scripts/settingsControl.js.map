{"version":3,"sources":["../../scripts/settingsControl.js"],"names":["document","body","classList","contains","sendData","data","url","isAsync","successCallback","errorCallback","xhr","XMLHttpRequest","open","onerror","onload","status","send","addButtonWaiter","element","disabled","style","backgroundImage","backgroundPosition","backgroundRepeat","backgroundSize","removeButtonWaiter","undefined","openButtons","querySelectorAll","changeButtons","button","addEventListener","event","preventDefault","section","nextElementSibling","maxHeight","String","calculateHeight","inputs","parentElement","children","slice","length","every","inp","value","endCallback","notify","bind","error","message","bgColors","success","failure","warning","colors","isFixed","type","TypeError","messageWindow","createElement","title","innerHTML","notifyStyles","left","right","top","padding","textAlign","border","zIndex","backgroundColor","color","cursor","position","Object","assign","delayedRemoval","setTimeout","removeChild","clearTimeout","insertBefore","firstElementChild","reduce","init","cur","computedStyle","window","getComputedStyle","parseInt","height","marginTop","marginBottom","borderTopWidth","borderBottomWidth","paddingBottom","paddingTop"],"mappings":"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","file":"settingsControl.js","sourcesContent":["try {\r\n    if (document.body.classList.contains('settings-body')) {\r\n        let openButtons = document.querySelectorAll('.main-settings__section-opener');\r\n        let changeButtons = document.querySelectorAll('.main-settings__change-button');\r\n\r\n        for (let button of openButtons) {\r\n            button.addEventListener('click', function (event) {\r\n                event.preventDefault();\r\n                let section = this.nextElementSibling;\r\n                // Вычисление высоты для раскрывающегося списка\r\n\r\n                if (!section.style.maxHeight) {\r\n                    section.style.maxHeight = String(calculateHeight(section)) + 'px';\r\n                } else {\r\n                    section.style.maxHeight = '';\r\n                }\r\n            })\r\n        }\r\n// TODO Сделать нормальную отправку данных\r\n        for (let button of changeButtons) {\r\n            button.addEventListener('click', function (event) {\r\n                event.preventDefault();\r\n                let inputs = [...this.parentElement.children].slice(0, this.parentElement.children.length - 1);\r\n                if (inputs.every(inp => inp.value)) {\r\n                    addButtonWaiter(this);\r\n                    let endCallback = function () {\r\n                        removeButtonWaiter(this);\r\n                        notify(true, 'Инструкция по смене данных отправлена на вашу почту.', 'success');\r\n                    }.bind(this);\r\n                    let errorCallback = function () {\r\n                        removeButtonWaiter(this);\r\n                        notify(true, 'При смене данных возникла ошибка. Попробуйте еще раз.', 'failure');\r\n                    }.bind(this);\r\n\r\n                    sendData('test', 'https://www.example.com', true, endCallback, errorCallback);\r\n                } else {\r\n                    notify(true, 'Пожалуйста, заполните все поля', 'warning');\r\n                }\r\n            })\r\n        }\r\n\r\n        function sendData(data, url, isAsync, successCallback, errorCallback) {\r\n            let xhr = new XMLHttpRequest();\r\n            xhr.open('POST', url, isAsync);\r\n            xhr.onerror = errorCallback;\r\n            xhr.onload = function () {\r\n                if (xhr.status === 200) {\r\n                    successCallback();\r\n                } else {\r\n                    errorCallback();\r\n                }\r\n            };\r\n            xhr.send(data);\r\n        }\r\n\r\n        function addButtonWaiter(element) {\r\n            element.disabled = true;\r\n            element.style.backgroundImage = 'url(\"../images/loading-light.svg\")';\r\n            element.style.backgroundPosition = '5px 50%';\r\n            element.style.backgroundRepeat = 'no-repeat';\r\n            element.style.backgroundSize = '35px 35px';\r\n        }\r\n\r\n        function removeButtonWaiter(element) {\r\n            element.disabled = undefined;\r\n            element.style.backgroundImage = '';\r\n            element.style.backgroundPosition = '';\r\n            element.style.backgroundRepeat = '';\r\n            element.style.backgroundSize = '';\r\n        }\r\n    }\r\n} catch (error) {\r\n    notify(true, `Что-то пошло не так: ${error.message}`, 'failure');\r\n}\r\n\r\nlet bgColors = {\r\n    success: '#6eff95',\r\n    failure: '#ff0000',\r\n    warning: '#fcff5a'\r\n};\r\nlet colors = {\r\n    success: '#00a919',\r\n    failure: '#850000',\r\n    warning: '#de8004'\r\n};\r\n\r\n/**\r\n * Выводит уведомление, позиционированное сверху экрана и фиксированное при необходимости, в указанный элемент\r\n * @param {Boolean} isFixed\r\n * @param {String} message\r\n * @param {String} type\r\n * @param {HTMLElement} element\r\n */\r\nfunction notify(isFixed, message, type, element = document.body) {\r\n    if (type !== 'success' && type !== 'failure' && type !== 'warning') {\r\n        throw new TypeError('Неверное имя типа. Принимаются только \"success\", \"warning\" или \"failure\"');\r\n    }\r\n    let messageWindow = document.createElement('div');\r\n    messageWindow.title = 'Скрыть';\r\n    messageWindow.innerHTML = message;\r\n\r\n    let notifyStyles = {\r\n        left: '0',\r\n        right: '0',\r\n        top: '0',\r\n        padding: '10px',\r\n        textAlign: 'center',\r\n        border: '2px solid',\r\n        zIndex: '20',\r\n        backgroundColor: bgColors[type],\r\n        color: colors[type],\r\n        cursor: 'pointer',\r\n        position: isFixed ? 'fixed' : 'absolute'\r\n    };\r\n    Object.assign(messageWindow.style, notifyStyles);\r\n\r\n    let delayedRemoval = setTimeout(function () {\r\n        element.removeChild(messageWindow);\r\n    }, 5000);\r\n\r\n    messageWindow.addEventListener('click', function () {\r\n        element.removeChild(messageWindow);\r\n        clearTimeout(delayedRemoval);\r\n    });\r\n\r\n    element.insertBefore(messageWindow, element.firstElementChild);\r\n}\r\n\r\nfunction calculateHeight(element) {\r\n    return[...element.children].reduce((init, cur) => {\r\n        let computedStyle = window.getComputedStyle(cur);\r\n        return init + parseInt(computedStyle.height) +\r\n            parseInt(computedStyle.marginTop) +\r\n            parseInt(computedStyle.marginBottom) +\r\n            parseInt(computedStyle.borderTopWidth) +\r\n            parseInt(computedStyle.borderBottomWidth) +\r\n            parseInt(computedStyle.paddingBottom) +\r\n            parseInt(computedStyle.paddingTop);\r\n    }, 0);\r\n}"]}