{"version":3,"sources":["../../scripts/groupsControl.js"],"names":["document","body","classList","contains","getGroupsData","url","Promise","resolve","reject","xhr","XMLHttpRequest","overrideMimeType","open","onload","status","JSON","parse","responseText","groups","Error","onerror","send","createGroup","groupObj","groupHolder","createElement","add","group","id","free","innerHTML","freeStudents","groupsListForRed","length","deleteButton","querySelector","redButton","addEventListener","event","preventDefault","notify","window","location","origin","reload","students","currentFreeStudents","slice","newGroupList","filter","obj","push","stringify","nameChanger","value","parentElement","name","changeButton","list","makeListForSelect","enteredName","firstElementChild","currentStudents","console","log","allStudents","children","selectedStudents","opt","selected","map","studentObj","unseectedStudents","holder","createGroupChangingInterface","placeForData","replaceChild","forEach","createStudent","student","appendChild","el","studentRadioContainer","studentLabelContainer","createPersonalTable","tableData","thead","tbody","table","className","line","number","row","success","theme","speed","capacity","quantity","rating","multiple","makeOptions","isSelected","option","button","Object","assign","style","animationName","animationDuration","loadingPlaceholder","createButton","groupsListElement","promiseGroupList","then","groupList","removeChild","insertBefore","lastElementChild","querySelectorAll","studentRadios","radio","checked","setRequestHeader","data","showGroup","height","calculateHeight","maxHeight","String","disabled","placeholder","evt","newGroup","freeGroup","pop","catch","err","message","element","reduce","init","cur","computedStyle","getComputedStyle","parseInt","marginTop","marginBottom","borderTopWidth","borderBottomWidth","paddingBottom","paddingTop"],"mappings":"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","file":"groupsControl.js","sourcesContent":["if (document.body.classList.contains('groups-body')) {\r\n    let loadingPlaceholder = document.createElement('div');\r\n    loadingPlaceholder.className = 'loading-placeholder';\r\n\r\n    let groupsListForRed;\r\n    let createButton = document.querySelector('.groups__create-btn');\r\n    let placeForData = document.querySelector('.action-place');\r\n    let groupsListElement = document.querySelector('.groups__list');\r\n// TODO Изменить запрос\r\n    let promiseGroupList = getGroupsData(`${window.location.origin}/testData/groupList.json`);\r\n    promiseGroupList.then(groupList => {\r\n        groupsListForRed = groupList;\r\n        groupsListElement.removeChild(groupsListElement.firstElementChild);\r\n        groupList.forEach(group => groupsListElement.insertBefore(createGroup(group), groupsListElement.lastElementChild));\r\n\r\n        let groups = document.querySelectorAll('.group-holder');\r\n        let studentRadios = document.querySelectorAll('.student__radio');\r\n\r\n        [...studentRadios].forEach(radio => radio.addEventListener('change', function () {\r\n            if (this.checked) {\r\n                placeForData.replaceChild(loadingPlaceholder, placeForData.firstElementChild);\r\n\r\n                let xhr = new XMLHttpRequest();\r\n                xhr.open('GET', `${window.location.origin}/statsTable`, true);\r\n                xhr.setRequestHeader('Content-Type', 'application/json');\r\n\r\n                xhr.onload = function () {\r\n                    if (xhr.status === 200) {\r\n                        let table = createPersonalTable(JSON.parse(xhr.responseText).data);\r\n                        table.style.animationName = 'fade';\r\n                        table.style.animationDuration = '1s';\r\n                        placeForData.replaceChild(table, placeForData.firstElementChild);\r\n                    } else {\r\n                        notify(true, `Ошибка получения информации об ученике (${xhr.status})`, 'failure');\r\n                    }\r\n                };\r\n                xhr.onerror = function () {\r\n                    notify(true, `Ошибка получения информации об ученике (${xhr.status})`, 'failure');\r\n                };\r\n\r\n                xhr.send();\r\n            }\r\n        }));\r\n        [...groups].forEach(group => {\r\n            let groupList = group.querySelector('.group');\r\n            let showGroup = group.querySelector('.group__checkbox');\r\n            let height = calculateHeight(groupList);\r\n\r\n            showGroup.addEventListener('change', function () {\r\n                if (this.checked) {\r\n                    groupList.style.maxHeight = String(height) + 'px';\r\n                }\r\n                else {\r\n                    groupList.style.maxHeight = '0';\r\n                }\r\n            })\r\n        });\r\n\r\n        createButton.disabled = '';\r\n\r\n        createButton.addEventListener('click', function (event) {\r\n            event.preventDefault();\r\n\r\n            let nameChanger = document.createElement('input');\r\n            nameChanger.placeholder = 'Название группы...';\r\n            nameChanger.classList.add('input_light-theme', 'groups-change-interface__name-changer');\r\n\r\n            let changeButton = document.createElement('button');\r\n            changeButton.innerHTML = 'Создать';\r\n            changeButton.classList.add('button_dark-theme', 'groups-change-interface__btn');\r\n\r\n            changeButton.addEventListener('click', function (evt) {\r\n                evt.preventDefault();\r\n                if (nameChanger.value) {\r\n                    let currentFreeStudents = groupsListForRed[groupsListForRed.length - 1].students.slice();\r\n\r\n                    let xhr = new XMLHttpRequest();\r\n                    xhr.open('POST', `${window.location.origin}/groups/add`, true);\r\n                    xhr.setRequestHeader('Content-Type', 'application/json');\r\n\r\n                    xhr.onload = function () {\r\n                        if (xhr.status === 200) {\r\n                            location.reload(true);\r\n                        } else {\r\n                            notify(true, `Произошла ошибка при создании (${xhr.status})`, 'failure');\r\n                            groupsListForRed[groupsListForRed.length - 1].students = currentFreeStudents;\r\n                            console.log(groupsListForRed);\r\n                        }\r\n                    };\r\n\r\n                    let allStudents = [...list.children];\r\n                    let newGroup = {\r\n                        name: nameChanger.value,\r\n                        students: allStudents.filter(opt => opt.selected).map(({studentObj}) => studentObj)\r\n                    };\r\n                    let freeGroup = {\r\n                        name: 'Не распределенные',\r\n                        free: true,\r\n                        students: allStudents.filter(opt => !opt.selected).map(({studentObj}) => studentObj)\r\n                    };\r\n                    let newGroupList = groupsListForRed.slice();\r\n                    newGroupList.pop();\r\n                    // TODO Придумать что-нибудь с id или оставить так как есть\r\n                    if (newGroupList.length) {\r\n                        newGroup.id = newGroupList[newGroupList.length - 1].id + 1;\r\n                    } else {\r\n                        newGroup.id = 1\r\n                    }\r\n                    newGroupList.push(newGroup, freeGroup);\r\n                    xhr.send(JSON.stringify(newGroupList));\r\n                } else {\r\n                    notify(true, 'Пожалуйста введите имя шруппы', 'warning');\r\n                }\r\n            });\r\n\r\n            let list = makeListForSelect();\r\n            list.classList.add('groups-change-interface__list');\r\n\r\n            let holder = createGroupChangingInterface(nameChanger, list, changeButton);\r\n\r\n            placeForData.replaceChild(holder, placeForData.firstElementChild);\r\n        })\r\n    }).catch(err => {\r\n        notify(true, `Что-то пошло не так: ${err.message}`, 'failure');\r\n    });\r\n\r\n    function getGroupsData(url) {\r\n        return new Promise(function (resolve, reject) {\r\n            let xhr = new XMLHttpRequest();\r\n            xhr.overrideMimeType('application/json');\r\n            xhr.open('GET', url, true);\r\n            xhr.onload = function () {\r\n                if (xhr.status === 200) {\r\n                    resolve(JSON.parse(xhr.responseText).groups);\r\n                }\r\n                else {\r\n                    reject(new Error(`Ошибка получения информации о группах (${xhr.status})`));\r\n                }\r\n            };\r\n            xhr.onerror = function () {\r\n                reject(new Error(`Ошибка получения информации о группах (${xhr.status})`));\r\n            };\r\n            xhr.send();\r\n        })\r\n    }\r\n\r\n    function createGroup(groupObj) {\r\n        let groupHolder = document.createElement('div');\r\n        groupHolder.classList.add('group-holder');\r\n        let group = document.createElement('div');\r\n        group.id = groupObj.id;\r\n        group.groupObj = groupObj;\r\n        group.classList.add('group');\r\n        if (!groupObj.free) {\r\n            group.innerHTML =\r\n                `<button class=\"button_light-theme groups__delete-btn\">Удалить</button>\r\n                 <button class=\"button_light-theme groups__red-btn\">Редактировать</button>`;\r\n\r\n            let freeStudents = groupsListForRed[groupsListForRed.length - 1];\r\n\r\n            let deleteButton = group.querySelector('.groups__delete-btn');\r\n            let redButton = group.querySelector('.groups__red-btn');\r\n\r\n            // Удаление группы\r\n            deleteButton.addEventListener('click', function (event) {\r\n                event.preventDefault();\r\n                notify('true', 'Вы действительно хотите удалить группу?', 'confirm', function () {\r\n                    let xhr = new XMLHttpRequest();\r\n                    xhr.overrideMimeType('application/json');\r\n                    xhr.open('POST', `${window.location.origin}/groups/delete`, true);\r\n                    xhr.onload = function () {\r\n                        if (xhr.status === 200) {\r\n                            location.reload(true);\r\n                        } else {\r\n                            notify(true, `Произошла ошибка при удалении (${xhr.status})`, 'failure')\r\n                            freeStudents.students = currentFreeStudents;\r\n                        }\r\n                    };\r\n                    // Спасаем текущее состояние\r\n                    let currentFreeStudents = freeStudents.students.slice();\r\n                    // Создаем новую группу для отправки\r\n                    let newGroupList = groupsListForRed.filter(obj => obj !== groupObj);\r\n                    // Освобождаем учеников из удаленной группы\r\n                    freeStudents.students.push(...groupObj.students);\r\n                    // Отправляем данные о новой группе на сервер\r\n                    xhr.send(JSON.stringify(newGroupList));\r\n                });\r\n            });\r\n\r\n            redButton.addEventListener('click', function (event) {\r\n                event.preventDefault();\r\n\r\n                let nameChanger = document.createElement('input');\r\n                nameChanger.value = this.parentElement.groupObj.name;\r\n                nameChanger.classList.add('input_light-theme', 'groups-change-interface__name-changer');\r\n\r\n                let changeButton = document.createElement('button');\r\n                changeButton.classList.add('button_dark-theme', 'groups-change-interface__btn');\r\n\r\n                let list = makeListForSelect(groupObj);\r\n                list.classList.add('groups-change-interface__list');\r\n\r\n                changeButton.innerHTML = 'Изменить группу';\r\n                changeButton.addEventListener('click', function (event) {\r\n                    event.preventDefault();\r\n                    let enteredName = this.parentElement.firstElementChild.value;\r\n                    if (enteredName) {\r\n                        let currentStudents = groupObj.students.slice();\r\n                        let currentFreeStudents = freeStudents.students.slice();\r\n\r\n                        let xhr = new XMLHttpRequest();\r\n                        xhr.overrideMimeType('application/json');\r\n                        xhr.open('POST', `${window.location.origin}/groups/red`, true);\r\n                        xhr.onload = function () {\r\n                            if (xhr.status === 200) {\r\n                                location.reload(true);\r\n                            } else {\r\n                                notify(true, `Произошла ошибка при редактировании (${xhr.status})`, 'failure');\r\n                                groupObj.students = currentStudents;\r\n                                freeStudents.students = currentFreeStudents;\r\n                                console.log(groupsListForRed);\r\n                            }\r\n                        };\r\n\r\n                        let allStudents = [...list.children];\r\n                        let selectedStudents = allStudents.filter(opt => opt.selected).map(({studentObj}) => studentObj);\r\n                        let unseectedStudents = allStudents.filter(opt => !opt.selected).map(({studentObj}) => studentObj);\r\n\r\n                        groupObj.students = selectedStudents;\r\n                        freeStudents.students = unseectedStudents;\r\n                        groupObj.name = enteredName;\r\n                        xhr.send(JSON.stringify(groupsListForRed));\r\n                    } else {\r\n                        notify(true, 'Пожалуйста введите имя группы', 'warning');\r\n                    }\r\n\r\n\r\n                });\r\n\r\n                let holder = createGroupChangingInterface(nameChanger, list, changeButton);\r\n\r\n                placeForData.replaceChild(holder, placeForData.firstElementChild);\r\n            })\r\n        }\r\n        groupHolder.innerHTML =\r\n            `<input class=\"group__checkbox\" type=\"checkbox\" name=\"group\" id=\"group-${groupObj.id}\">\r\n             <label class=\"group__name\" for=\"group-${groupObj.id}\">${groupObj.name}</label>`;\r\n        groupObj.students.forEach(student => createStudent(student).forEach(el => group.appendChild(el)));\r\n        groupHolder.appendChild(group);\r\n\r\n        return groupHolder;\r\n    }\r\n\r\n    function createStudent(studentObj) {\r\n        let studentRadioContainer = document.createElement('div');\r\n        let studentLabelContainer = document.createElement('div');\r\n        studentRadioContainer.innerHTML = `<input type=\"radio\" name=\"student\" id=\"student-${studentObj.id}\" class=\"student__radio\">`;\r\n        studentLabelContainer.innerHTML = `<label for=\"student-${studentObj.id}\" class=\"group__student\">${studentObj.name}</label>`;\r\n\r\n        return [studentRadioContainer.firstElementChild, studentLabelContainer.firstElementChild];\r\n    }\r\n\r\n    function createPersonalTable(tableData) {\r\n        let thead = document.createElement('thead');\r\n        let tbody = document.createElement('tbody');\r\n        let table = document.createElement('table');\r\n        table.className = 'stats__table table_light-theme';\r\n        thead.innerHTML = '<tr class=\"stats__row\"><th class=\"stats__data table_light-theme font-weight-bold\">№</th>\\n' +\r\n            '<th class=\"stats__data table_light-theme font-weight-bold\">Результат</th>\\n' +\r\n            '<th class=\"stats__data table_light-theme font-weight-bold\">Тема</th>\\n' +\r\n            '<th class=\"stats__data table_light-theme font-weight-bold\">Скорость</th>\\n' +\r\n            '<th class=\"stats__data table_light-theme font-weight-bold\">Разрядность</th>\\n' +\r\n            '<th class=\"stats__data table_light-theme font-weight-bold\">Количество</th>' +\r\n            '<th class=\"stats__data table_light-theme font-weight-bold\">Тип рейтинга</th>' +\r\n            '</tr>';\r\n        tableData.forEach((line, number) => {\r\n            let row = document.createElement('tr');\r\n            row.innerHTML = `<td class=\"stats__data table_light-theme\">${number + 1}</td>\r\n            <td class=\"stats__data table_light-theme ${line.success ? 'success' : 'failure'}\">${line.success ? 'Успех' : 'Неудача'}</td>\r\n            <td class=\"stats__data table_light-theme\">${line.theme}</td>\r\n            <td class=\"stats__data table_light-theme\">${line.speed + 'сек'}</td>\r\n            <td class=\"stats__data table_light-theme\">${line.capacity}</td>\r\n            <td class=\"stats__data table_light-theme\">${line.quantity}</td>\r\n            <td class=\"stats__data table_light-theme\">${line.rating}</td>`;\r\n            tbody.appendChild(row);\r\n        });\r\n        table.appendChild(thead);\r\n        table.appendChild(tbody);\r\n        return table;\r\n    }\r\n\r\n    function makeListForSelect(group = null) {\r\n        let list = document.createElement('select');\r\n        list.multiple = true;\r\n        let freeStudents = groupsListForRed[groupsListForRed.length - 1].students;\r\n        if (group) {\r\n            group.students.forEach(student => makeOptions(student, true));\r\n        }\r\n        freeStudents.forEach(student => makeOptions(student));\r\n\r\n        function makeOptions(student, isSelected = false) {\r\n            let option = document.createElement('option');\r\n            option.innerHTML = student.name;\r\n            option.studentObj = student;\r\n            option.value = student.id;\r\n            option.selected = isSelected ? true : '';\r\n            list.appendChild(option);\r\n        }\r\n\r\n        return list;\r\n    }\r\n\r\n    function createGroupChangingInterface(nameChanger, list, button) {\r\n        let holder = document.createElement('div');\r\n        holder.classList.add('groups-change-interface');\r\n        holder.appendChild(nameChanger);\r\n        holder.appendChild(list);\r\n        holder.appendChild(button);\r\n        Object.assign(holder.style, {\r\n            animationName: 'fade',\r\n            animationDuration: '1s'\r\n        });\r\n\r\n        return holder;\r\n    }\r\n\r\n}\r\n\r\nfunction calculateHeight(element) {\r\n    return [...element.children].reduce((init, cur) => {\r\n        let computedStyle = window.getComputedStyle(cur);\r\n        return init + parseInt(computedStyle.height) +\r\n            parseInt(computedStyle.marginTop) +\r\n            parseInt(computedStyle.marginBottom) +\r\n            parseInt(computedStyle.borderTopWidth) +\r\n            parseInt(computedStyle.borderBottomWidth) +\r\n            parseInt(computedStyle.paddingBottom) +\r\n            parseInt(computedStyle.paddingTop);\r\n    }, 0);\r\n}\r\n"]}